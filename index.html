<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Studio - Biagetti</title>
    <style>
        :root { --primary: #00d4ff; --bg: #121212; --panel: #1e1e1e; }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background: var(--bg); color: #fff; display: flex; height: 100vh; overflow: hidden; }
        
        #sidebar { width: 300px; min-width: 300px; background: var(--panel); border-right: 2px solid var(--primary); display: flex; flex-direction: column; padding: 15px; }
        
        /* PULSANTE TABLET */
        .tablet-link { 
            background: #ff9800; color: black; text-decoration: none; text-align: center; 
            padding: 10px; border-radius: 5px; font-weight: bold; margin-bottom: 15px; 
        }

        #playlist { flex: 1; overflow-y: auto; list-style: none; padding: 0; margin: 10px 0; }
        #playlist li { padding: 12px; border-bottom: 1px solid #333; cursor: pointer; font-size: 0.9rem; }
        #playlist li.active { background: #005bb5; color: white; }

        #main-viewer { flex-grow: 1; background: #333; }
        iframe { width: 100%; height: 100%; border: none; }

        .controls { background: #181818; padding: 15px; border-top: 1px solid #444; }
        audio { width: 100%; }
    </style>
</head>
<body>

    <div id="sidebar">
        <a href="tablet.html" class="tablet-link">USA VERSIONE TABLET ðŸ“±</a>
        <h2 style="color:var(--primary); text-align:center; margin-top:0;">ARCHIVIO PC</h2>
        <ul id="playlist"></ul>
        <div class="controls">
            <audio id="player" controls></audio>
        </div>
    </div>

    <div id="main-viewer">
        <iframe id="pdf-content" src=""></iframe>
    </div>

    <script>
        const UTENTE = "BiagettiLuigino";
        const REPO = "mio-archivio-musicale";

        async function init() {
            const response = await fetch(`https://api.github.com/repos/${UTENTE}/${REPO}/contents/`);
            const files = await response.json();
            const list = document.getElementById('playlist');
            
            files.filter(f => f.name.toLowerCase().endsWith('.mp3')).forEach(file => {
                const baseName = file.name.replace(".mp3", "");
                const li = document.createElement('li');
                li.innerText = baseName.replace(/_/g, " ");
                li.onclick = () => {
                    document.querySelectorAll('li').forEach(l => l.classList.remove('active'));
                    li.classList.add('active');
                    document.getElementById('pdf-content').src = encodeURI(baseName + ".pdf");
                    const player = document.getElementById('player');
                    player.src = encodeURI(file.name);
                    player.play();
                };
                list.appendChild(li);
            });
        }
        window.onload = init;
    </script>
</body>
</html>
